Start with:

Figure out how temp file is handled in Rails 3.
The Rack::Test::UploadedFile isn't a temp file and needs to exist or throws an error.

Open Issues
===========
* Lots of tests fail due to 'uninitialized constant ActionController::UploadedTempfile'
* No route found for /  (Neither root nor match "/" seem to work)
* It appears no CMS pages work. (The 'catchall' route doesn't work)
* Pages do not render their status icon in the sitemap.
* link_to_function has been removed. Check All and uncheck all are currently broken (See ApplicationHelper)
* No such method 'callback' for blocks during saving. (Versioning.save line #121)
* Attachments throw errors (uninitialized constant ActionController::UploadedTempfile)
* Saving a block with unchanged value shouldn't create additional versions (rake test:units TEST=unit/lib/content_block_test.rb)
* Deleting blocks doesn't work. (Might actually be problems with queries)
* Altering the uploaded file may not change the name of the file. (Broken test or broken feature?)

To Do List
==========
0. Install jeweler for 1.9.1 to get rid of warnings. (I commented out Jeweler for now)
1. Build the gem and test it against a new rails 3 project.
2. Verify it works in 1.8.7
3. Determine if both Rails 2 and 3 can be supported in the same gem.

Fixing Default Routes
===========
The 'catchall' route seems to split the path into an array. The content controller reassembles it. I have reversed this procedure.
Need to review the routing code/Yehuta's articles on this, as I think I'm making a mess of it.

Making save work
================
Reworked save to use normal callback behavior, rather than overriding save_with_validations.

Known Issues:
- Updating with the same attributes shouldn't be creating new versions (I think)
- Destroying is throwing errors.

The callback method has been removed. Versioning#save used it to trigger normal callback behavior. Relevant classes include:
ActiveRecord::Callbacks, ActiveModel::Callbacks, ActiveSupport::Callbacks

How Versioning works now (It might be necessary to rewrite)
--

How ActiveRecord works:
--
AR::Base - Defines a 'save' method with no params
AR::Validations - alias save to a save_with_validations (which takes params) 
ActiveRecord Object has:
- save_with_validations(options)
- save_without_validation() - (Original save)


Items Completed
===============
1. Hacked some helpers to not return unsafe strings. This needs to be really fixed.
2. Upgraded the 'stock' Rails files of BrowserCMS to use Rails 3.
3. Upgraded factory_girl to use a Rails 3/git based version
4. Added bundler configuration (this will need to be documented).
5. Sitemap folders now render correctly (fixed raw/h strings issue). Buttons too.
6. Removed calls to 'after_validation_on_update' in favor of 'after_validation' with a check for new_record?

Other Notes
==========
1. Some versions of 1.8.7-p248 and later have random Segmentation Fault/Bus issues with databases. See
    * http://busyprogrammer.wordpress.com/tag/bus-error/
    * Segmentation Fault - http://busyprogrammer.wordpress.com/tag/bus-error/ Only 1.8.7 p249