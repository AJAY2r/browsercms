Current Issue: Get pages to display, with toolbar, when logged in, without using a 'hack' for routes.
Currently, its impossible to manually test the UI.

Previous Issue: When saving blocks attached to a page, an incorrect number of connectors are being created (content_block_test.rb)

Start with:
 rake test:units TEST=unit/lib/content_block_test.rb

    A new connector is being created when a block is updated, but it's id is nil.
    No connectors are being found when it gets filtered down to the page and block version.
    See comments/logging in connecting.rb for update_connected_pages and connector.rb for find_connectable
    
    Look at ActiveSupport.on_load for things that went missing.
    Learn how to use the ruby debugger from the command line (or get RubyMine 2.5)


State of Test Cases (As of July 30, 2010)
====================
Unit - 19 Failures, 19 Errors
Functional - 38 Failures, 14 Errors
Integration - All Pass


Open Issues
===========
1. When saving blocks attached to a page, an incorrect number of connectors are being created (content_block_test.rb)
2. Content pages are not being found. This might require abandoning the Deprecated Router. (Need to figure out how routes from gems can be embedded)
3. No route found for /  (Neither root nor match "/" seem to work)    [Currently #2/3 are being solved locally via a workaround]
4. Pages do not render their status icon in the sitemap.
5. link_to_function has been removed. Check All and uncheck all are currently broken (See ApplicationHelper)
6. Attachments throw errors (uninitialized constant ActionController::UploadedTempfile)
7. Saving a block with unchanged value shouldn't create additional versions (rake test:units TEST=unit/lib/content_block_test.rb)
8. The toolbar is not appearing on pages (might be side effect of workaround for #2/3
9. Auto path suggestion doesn't work.
10. Cannot add blocks to pages
* Deleting blocks doesn't work. (Might actually be problems with queries)
* Altering the uploaded file may not change the name of the file. (Broken test or broken feature?)
* require_javascript_include - Tests are broken (probably due to changes to rails internals) 
* save! is broken (Maybe)
* Will need to rewrite generators to use Thor (Will require new fork)
* Look at how ActionSupport works with providing hooks

Good Ideas
* Rewrite Behaviors to use ActiveSupport::Concern (at least look at it to see what is useful)
* Not sure Publishing and Versioning should be split up. They are really intertwined in practice.
* Start introducing cucumber tests

CMS Behavior Dependencies
================
* Connecting -> Versioning (.draft)
* Versioning -> Publishing (.publish)

To Do List
==========
1. Build the gem and test it against a new rails 3 project.
2. Verify it works in 1.8.7
3. Determine if both Rails 2 and 3 can be supported in the same gem.


Making save work
================
Reworked save to use normal callback behavior, rather than overriding save_with_validations.

Known Issues:
- Destroying is throwing errors.


ActiveRecord alias chain- Here is the order that methods get called.
--
save
  save_with_transactions
  save_with_dirty
  save_with_validations
  AR::Base.save (save_without_validations)
  AR::Base.create_or_update_with_callbacks

  
AR::Base - Defines a 'save' method with no params
AR::Validations - alias save to a save_with_validations (which takes params) 
ActiveRecord Object has:
- save_with_validations(options)
- save_without_validation() - (Original save)


Items Completed
===============
1. Hacked some helpers to not return unsafe strings. This needs to be really fixed.
2. Upgraded the 'stock' Rails files of BrowserCMS to use Rails 3.
3. Upgraded factory_girl to use a Rails 3/git based version
4. Added bundler configuration (this will need to be documented).
5. Sitemap folders now render correctly (fixed raw/h strings issue). Buttons too.
6. Removed calls to 'after_validation_on_update' in favor of 'after_validation' with a check for new_record?
7. SITE_DOMAIN was a constant can't be found since there is no more global namespace. (Read up on how to add new configuration to Rails apps via configuration)
  (SITE_DOMAIN is fixed, but might not work correctly when new BrowserCMS projects are generated)
8. Rewrote versioning to override the correct method for handling callbacks.
9. Catchall route used to split path into an array, then the content controller would reassemble it. I have reversed this procedure.
10. Hard coded two paths into the browsercms config/routes.rb to allow routes to work.

Other Notes
==========
1. Some versions of 1.8.7-p248 and later have random Segmentation Fault/Bus issues with databases. See
    * http://busyprogrammer.wordpress.com/tag/bus-error/
    * Segmentation Fault - http://busyprogrammer.wordpress.com/tag/bus-error/ Only 1.8.7 p249